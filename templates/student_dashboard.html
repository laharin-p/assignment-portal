<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Student Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <h1>Welcome, {{ student.name }}</h1>
    <a href="{{ url_for('student_logout') }}">Logout</a>
    <hr>

    <h2>Available Assignments</h2>
    {% if available_assignments %}
        <table border="1" cellpadding="5">
            <tr>
                <th>Title</th>
                <th>Due In (Days)</th>
                <th>Action</th>
            </tr>
            {% for item in available_assignments %}
            <tr style="background-color: {{ item.color }}">
                <td>{{ item.assignment.title }}</td>
                <td>{{ item.days_left }}</td>
                <td>
                    {% if item.can_upload %}
                    <form action="{{ url_for('submit_assignment', assignment_id=item.assignment.id) }}" method="post" enctype="multipart/form-data">
                        <input type="file" name="file" required>
                        <button type="submit">Upload</button>
                    </form>
                    {% else %}
                        <span>Deadline Passed</span>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </table>
    {% else %}
        <p>No assignments available.</p>
    {% endif %}

    <hr>
    <h2>Submitted Assignments</h2>
    {% if submitted_assignments %}
        <table border="1" cellpadding="5">
            <tr>
                <th>Title</th>
                <th>Submitted On</th>
                <th>Plagiarism Score</th>
                <th>Days Left</th>
                <th>File</th>
            </tr>
            {% for item in submitted_assignments %}
            <tr style="background-color: {{ item.color }}">
                <td>{{ item.assignment.title }}</td>
                <td>{{ item.submitted_on }}</td>
                <td>{{ item.plagiarism_score }}%</td>
                <td>{{ item.days_left }}</td>
                <td><a href="{{ url_for('open_file') }}?url={{ item.file_url }}" target="_blank">View</a></td>
            </tr>
            {% endfor %}
        </table>
    {% else %}
        <p>No submissions yet.</p>
    {% endif %}
</body>
</html>