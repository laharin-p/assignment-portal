
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Submissions | {{ assignment.title }}</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
body{
    background:#f8f9fa;
    padding:20px;
}

.table th,
.table td{
    vertical-align:middle;
}

.plagiarism-high{
    background:#fff3cd; /* highlight high plagiarism */
}

.badge-plagiarism{
    font-size:.9rem;
}

.header-box{
    background:#ffffff;
    padding:15px;
    border-radius:8px;
    box-shadow:0 2px 8px rgba(0,0,0,.05);
    margin-bottom:20px;
}
</style>
</head>

<body>

<div class="container mt-4">

<div class="header-box">

<h3 class="mb-1">
ðŸ“„ Submissions â€” <strong>{{ assignment.title }}</strong>
</h3>

<p class="mb-0 text-muted">
Class: {{ assignment.branch }} {{ assignment.year }}-{{ assignment.section }}
</p>

</div>

<a href="{{ url_for('teacher_dashboard') }}"
   class="btn btn-secondary mb-3">
â¬… Back to Dashboard
</a>

{% if submissions and submissions|length > 0 %}

<div class="table-responsive">

<table class="table table-bordered table-hover align-middle">

<thead class="table-dark">
<tr>
<th>#</th>
<th>Student Name</th>
<th>Roll No</th>
<th>Submitted On</th>
<th>File</th>
<th>Plagiarism</th>
</tr>
</thead>

<tbody>

{% for sub in submissions %}

<tr class="{% if sub.plagiarism_score >= 50 %}plagiarism-high{% endif %}">

<td>{{ loop.index }}</td>

<td>{{ sub.student.name }}</td>

<td>{{ sub.student.roll_no }}</td>

<td>
{{ sub.submitted_on.strftime('%d-%m-%Y %I:%M %p') }}
</td>

<td>

<!-- Mobile + Desktop Open -->
<a href="{{ url_for('direct_file') }}?file_url={{ sub.file_url | urlencode }}"
   target="_blank"
   rel="noopener noreferrer"
   class="btn btn-sm btn-primary mb-1">
Open
</a>

<!-- Desktop Download -->
<a href="{{ url_for('direct_file') }}?file_url={{ sub.file_url | urlencode }}"
   download
   class="btn btn-sm btn-secondary mb-1 d-none d-md-inline">
Download
</a>

</td>

<td>

{% if sub.plagiarism_score >= 50 %}
<span class="badge bg-warning text-dark badge-plagiarism">
{{ sub.plagiarism_score }}%
</span>
{% else %}
<span class="badge bg-success badge-plagiarism">
{{ sub.plagiarism_score }}%
</span>
{% endif %}

</td>

</tr>

{% endfor %}

</tbody>

</table>

</div>

{% else %}

<p class="text-muted text-center fs-5 mt-4">
ðŸ“­ No submissions yet.
</p>

{% endif %}

</div>

</body>
</html>